# Highly Available Secrets
- [x] Terraform
- [x] Vault
- [x] Consul
- [x] AWS EKS
- [x] Kubernetes
---

## Prerequisites
1. AWS Account and IAM permissions to spin up resources
    - this repository uses an existing VPC and 2 subnets within the AWS account
2. `terraform`, `vault`, `consul`, `kubectl`
3. [aws-iam-authenticator](https://github.com/kubernetes-sigs/aws-iam-authenticator)
4. PKI for Vault and Consul
5. provide `*.tfvars` values
    - Consul Gossip Encryption Key can be generated by running `consul keygen`

## Managing Vault from your local machine
- `kubectl get pods` and copy vault pod name
- `kubectl port-forward <vault pod name> 8200:8200
- `export VAULT_ADDR=https://127.0.0.1:8200 export VAULT_CACERT=<pathtoca>`
- Start using `vault` CLI commands or navigate to `https://127.0.0.1:8200/ui` on a web browser

## Links
- [Terraform Configuration of AWS EKS](https://learn.hashicorp.com/terraform/aws/eks-intro#overview)
- [Running Vault and Consul on Kubernetes](https://testdriven.io/blog/running-vault-and-consul-on-kubernetes/)
- [aws-iam-authenticator](https://github.com/kubernetes-sigs/aws-iam-authenticator)
- [HashiCorp](https://www.hashicorp.com/)
- [Kubernetes](https://kubernetes.io/)
